num_cases %>%
mutate(proportion = n_cases / 354116) %>%  # n cases in study at same time
ggplot(aes(x = threshold, y = proportion), color = activity) +
geom_line(aes(linetype = activity)) +
theme_minimal()
# plot
num_cases %>%
ggplot(aes(x = threshold, y = n_cases), color = activity) +
geom_line(aes(linetype = activity)) +
theme_minimal()
# get proportion
num_cases %>%
mutate(proportion = n_cases / 354116) %>%  # n cases in study at same time
ggplot(aes(x = threshold, y = proportion), color = activity) +
geom_line(aes(linetype = activity)) +
theme_minimal()
dyad_sleep_diffs_df <- bind_rows(dyad_sleep_diffs)
dyad_steps_diffs <- bind_rows(dyad_steps_diffs)
dim(dyad_sleep_diffs_df)
names(dyad_sleep_diffs_df)
class(dyad_sleep_diffs_df$dyad_id)
dyad_sleep_diffs_df %>%
ggplot(aes(x = datadate,
y = diff,
color = as.factor(dyad_id),
group = as.factor(dyad_id))) +
geom_line(alpha = 0.1)
dyad_sleep_diffs[[1]] %>% select(datadate) %>% diff()
dyad_sleep_diffs[[1]] %>% select(datadate) %>% as.matric() %>% diff()
dyad_sleep_diffs[[1]] %>% select(datadate) %>% as.matrix() %>% diff()
dyad_sleep_diffs[[1]]
dyad_sleep_diffs[[1]] %>% select(datadate)
dyad_sleep_diffs[[1]] %>% select(datadate) %>% diff()
dyad_sleep_diffs[[1]]$datadate[2] - dyad_sleep_diffs[[1]]$datadate[1]
dyad_sleep_diffs[[1]]$datadate[2]
class(dyad_sleep_diffs[[1]]$datadate[2])
dyad_sleep_diffs[[1]] %>% select(datadate) %>% mutate(datadate = ymd(datadate))
dyad_sleep_diffs[[1]] %>% select(datadate) %>% mutate(datadate = ymd(datadate)) %>% diff()
class(dyad_sleep_diffs[[1]]$datadate[2])
dyad_sleep_diffs[[1]] %>% select(datadate) %>% mutate(datadate = ymd(datadate)) %>% difftime()
dyad_sleep_diffs[[1]] %>% select(datadate) %>% mutate(datadate = ymd(datadate)) %>% difftime(datadate)
dyad_sleep_diffs[[1]] %>% select(datadate) %>% mutate(datadate = ymd(datadate)) %>% pair.diff(datadate)
date_vec <- dyad_sleep_diffs[[1]]$datadate
class(date_vec)
date_vec <- dyad_sleep_diffs[[1]]$datadate %>% ymd()
class(date_vec)
length(date_vec)
date_vec[2:length(date_vec)]
length(date_vec[2:length(date_vec)])
length(date_vec[1:(length(date_vec)-1)])
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data %>%
select(date_var) %>%
ymd()
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- date_vec_1[2:length(date_vec1)]
date_vec_2 <- date_vec_2[1:(length(date_vec_2) - 1)]
# concatenate
dates <- cbind(date_vec_1, date_vec_2)
# return data
return(dates)
}
test <- get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data %>%
select(date_var) %>%
ymd()
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- date_vec_1[2:length(date_vec1)] %>% as_tibble()
date_vec_2 <- date_vec_2[1:(length(date_vec_2) - 1)] %>% as_tibble()
# concatenate
dates <- cbind(date_vec_1, date_vec_2)
# return data
return(dates)
}
test <- get_date_differences(dyad_sleep_diffs[[1]], datadate)
dyad_sleep_diffs[[1]] %>% select(datadate) %>% ymd()
names(dyad_sleep_diffs[[1]])
dyad_sleep_diffs[[1]] %>% select(datadate)
dyad_sleep_diffs[[2]] %>% select(datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data %>%
select(date_var)
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- date_vec_1[2:length(date_vec1)] %>% as_tibble()
date_vec_2 <- date_vec_2[1:(length(date_vec_2) - 1)] %>% as_tibble()
# concatenate
dates <- cbind(date_vec_1, date_vec_2)
# return data
return(dates)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data %>%
select(!! date_var)
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- date_vec_1[2:length(date_vec1)] %>% as_tibble()
date_vec_2 <- date_vec_2[1:(length(date_vec_2) - 1)] %>% as_tibble()
# concatenate
dates <- cbind(date_vec_1, date_vec_2)
# return data
return(dates)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data %>%
select(!! date_var)
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- date_vec_1[2:length(date_vec_1)] %>% as_tibble()
date_vec_2 <- date_vec_2[1:(length(date_vec_2) - 1)] %>% as_tibble()
# concatenate
dates <- cbind(date_vec_1, date_vec_2)
# return data
return(dates)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data %>%
select(!! date_var)
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- date_vec_1[2:length(date_vec_1)] %>% as_tibble()
date_vec_2 <- date_vec_2[1:-length(date_vec_2)] %>% as_tibble()
# concatenate
dates <- cbind(date_vec_1, date_vec_2)
# return data
return(dates)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data %>%
select(!! date_var)
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- date_vec_1[2:length(date_vec_1)] %>% as_tibble()
date_vec_2 <- date_vec_2[-length(date_vec_2)] %>% as_tibble()
# concatenate
dates <- cbind(date_vec_1, date_vec_2)
# return data
return(dates)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data %>%
select(!! date_var)
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- date_vec_1[2:length(date_vec_1)] %>% as_tibble()
date_vec_2 <- date_vec_2[-length(date_vec_2)] %>% as_tibble()
# # concatenate
# dates <- cbind(date_vec_1, date_vec_2)
#
# # return data
# return(dates)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
test <- c(1,2,3,4,5)
tail(test, -1)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- tail(date_vec_1, -1)
date_vec_2 <- head(date_vec_2, -1)
# # concatenate
# dates <- cbind(date_vec_1, date_vec_2)
#
# # return data
# return(dates)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- tail(date_vec_1, -1)
date_vec_2 <- head(date_vec_2, -1)
# # concatenate
# dates <- cbind(date_vec_1, date_vec_2)
#
# # return data
return(date_vec_2)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
# # concatenate
# dates <- cbind(date_vec_1, date_vec_2)
#
# # return data
return(date_vec_2)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
# concatenate
dates <- bind_cols(date_vec_1, date_vec_2)
# return data
return(dates)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
# get date vectors
date_vec_1 <- data
date_vec_2 <- date_vec_1
# remove first and last elements
date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
# concatenate
dates <- bind_cols(date_vec_1, date_vec_2)
# get differences
date_diffs <- dates$datadate - dates$datadate1
# return data
return(date_diffs)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
int_diff(dyad_sleep_diffs[[1]]$datadate)
int_diff(dyad_sleep_diffs[[1]]$datadate) %>% as.duration()
int_diff(dyad_sleep_diffs[[1]]$datadate) %>% as.duration() %>% seconds_to_period(86400)
int_diff(dyad_sleep_diffs[[1]]$datadate) %>% as.duration() %>% seconds_to_period()
int_diff(dyad_sleep_diffs[[1]]$datadate) %>% as.duration() %>% as.numeric()
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
diffs <- data %>%
select(date_var) %>%
int_diff(date_var) %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
return(diffs)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
diffs <- data %>%
select(!! date_var) %>%
int_diff(!! date_var) %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
return(diffs)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
diffs <- data %>%
select(!! date_var) %>%
int_diff(date_var) %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
return(diffs)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences <- function(data, date_var){
date_var <- enquo(date_var)
diffs <- data %>%
select(!! date_var) %>%
int_diff() %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
return(diffs)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
dyad_sleep_diffs[[1]] %>% select(datadate) %>% int_diff() %>% as.duration() %>% as.numeric()
dyad_sleep_diffs[[1]] %>% select(datadate) %>% int_diff()
dyad_sleep_diffs[[1]] %>% select(datadate) %>% int_diff(datadate)
get_date_differences <- function(date_vec){
date_var <- enquo(date_var)
diffs <- date_vec %>%
int_diff() %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
return(diffs)
}
get_date_differences(dyad_sleep_diffs[[1]]$datadate)
get_date_differences <- function(date_vec){
#date_var <- enquo(date_var)
diffs <- date_vec %>%
int_diff() %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
return(diffs)
}
get_date_differences(dyad_sleep_diffs[[1]], datadate)
get_date_differences(dyad_sleep_diffs[[1]]$datadate)
get_date_differences <- function(date_vec){
#date_var <- enquo(date_var)
diffs <- date_vec %>%
int_diff() %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
return(diffs / 86400)
}
get_date_differences(dyad_sleep_diffs[[1]]$datadate)
get_date_differences <- function(date_vec, format = "day"){
#date_var <- enquo(date_var)
diffs <- date_vec %>%
int_diff() %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
if(format == "day") {
return(diffs / 86400)
} else if (format == "seconds") {
return(diffs)
} else {
stop("You have chosen an unsupported date format!")
}
}
return(diffs / 86400)
get_date_differences <- function(date_vec, format = "day"){
#date_var <- enquo(date_var)
diffs <- date_vec %>%
int_diff() %>%
as.duration() %>%
as.numeric()
# # get date vectors
# date_vec_1 <- data
# date_vec_2 <- date_vec_1
#
# # remove first and last elements
# date_vec_1 <- tail(date_vec_1, -1) %>% select(datadate)
# date_vec_2 <- head(date_vec_2, -1) %>% select(datadate)
#
# # concatenate
# dates <- bind_cols(date_vec_1, date_vec_2)
#
# # get differences
# date_diffs <- dates %>%
#   datadate1 %--%
# return data
if(format == "day") {
return(diffs / 86400)
} else if (format == "seconds") {
return(diffs)
} else {
stop("You have chosen an unsupported date format!")
}
}
get_date_differences(dyad_sleep_diffs[[1]]$datadate)
get_date_differences(dyad_sleep_diffs[[1]]$datadate, "seconds")
library(ggplot2)
library(dplyr)
# load sleep data
dyad_sleep_diffs <- readRDS("dyad_sleep_diffs.rds")
# load steps data
dyad_steps_diffs <- readRDS("dyad_steps_diffs.rds")
get_date_differences <- function(data){
#date_var <- enquo(date_var)
diffs <- data$datadate %>%
int_diff() %>%
as.duration() %>%
as.numeric()
}
date_diffs_all_sleep <- lapply(dyad_sleep_diffs, get_date_differences)
num_cases
date_diffs_all_sleep <- bind_rows(date_diffs_all_sleep)
